<html>
<head>
	<!--<script src="file:///home/chronos/u-8c76189d6d79b89d2195035f0cec044aa6fc2aff/MyFiles/Downloads/elgesis_folder/plotly_chrome/plotly-latest.min.js"></script>-->
	<!--<script src="file:///home/chronos/u-8c76189d6d79b89d2195035f0cec044aa6fc2aff/MyFiles/Downloads/elgesis_folder/ultraObject_chrome/ultraObject.js"></script>-->
	<script src="http://24.189.66.225/backend/plotly"></script>
	<script src="http://24.189.66.225/backend/ultraObject"></script>
</head>
<body>
</body>
    <script>


    var parcats_FL_0_i = {
        forLoop_0_i:0,
        forLoopLength:3,
        fn:function(   dev_obj   ){
            var element11 = document.createElement("div")
            document.body.appendChild(element11)
            var node11 = document.querySelector('div')
            id11 = document.createAttribute("id")
            id11.value = 'myDiv' +parcats_FL_0_i.forLoop_0_i
            element11.setAttributeNode(id11)
        },
        args: {}
    }
    ultraObject.forLoop(   parcats_FL_0_i   )
    

    var randomData =  ultraObject.iterableObject()
    var parcats_FL_1_i = {
        forLoop_0_i:0,
        forLoopLength:15,
        fn:function(   dev_obj   ){
            
            randomData.add({
                value:ultraObject.XHR[   ultraObject.scope[   parcats_XHR_0_i ]   ].data[0]
            })
            ultraObject.XHR[   ultraObject.scope[   parcats_XHR_0_i ]   ].data[0] = {}
            // impt for the pointer to point to a new memory address to avoid your referencing problem
            parcats_FL_2_i.forLoopLength = Object.keys(   randomData[parcats_FL_1_i.forLoop_0_i ]   ).length,
            parcats_FL_2_i.args.total = 0
            ultraObject.forLoop(   parcats_FL_2_i    )
            ultraObject.XHR[   ultraObject.scope[   parcats_XHR_0_i ]   ].data[0].total = parcats_FL_2_i.args.total
            
        },
        args: {}
    }
    var parcats_FL_2_i = {
        forLoop_0_i:0,
        fn:function(   dev_obj   ){
            
            ultraObject.XHR[   ultraObject.scope[   parcats_XHR_0_i ]   ].data[0][   Object.keys(   randomData[parcats_FL_1_i.forLoop_0_i]    )[   parcats_FL_2_i.forLoop_0_i   ]   ] = Math.floor(  Math.random() *10 )
            parcats_FL_2_i.args.total += ultraObject.XHR[   ultraObject.scope[   parcats_XHR_0_i ]   ].data[0][   Object.keys(   randomData[parcats_FL_1_i.forLoop_0_i]    )[   parcats_FL_2_i.forLoop_0_i   ]   ]
            
        },
        args: {}
    }
    var parcats_FL_3_i = {
        forLoop_0_i:0,
        fn:function(   dev_obj   ){
            parcats_FL_3_i.args.target.push(   parcats_FL_3_i.args.source[   parcats_FL_3_i.forLoop_0_i   ]   )
        },
        args: {}
    }
    

    
var parcats_XHR_0_i
var resolveDiv0 = new Promise((resolve,reject)=>{
    var gd = document.getElementById('myDiv0');
    var categoricalDimensionLabels = [
      'element',
      'parents',
      'siblings',
      'children',
      'total'

    
    ];
    
    /*making the XHR for the db data from interrogation*/  //{
    ultraObject.endpoint({
        xhttp:ultraObject.iterify({iterify:[new XMLHttpRequest()]}),
        instruct:'XMLHttpRequest',
        eventName:'load',
        eventHandler:()=>{
            parcats_XHR_0_i  =  ultraObject.scope.add(   {value:ultraObject.XHR.abelast[ultraObject.XHR.abelast.length -1]}   )
            ultraObject.XHR[   ultraObject.scope[   parcats_XHR_0_i ]   ].data = JSON.parse(   ultraObject.XHR[   ultraObject.scope[   parcats_XHR_0_i ]   ][0].response   )
        },
        protocol:`POST`,
        target:`http://24.189.66.225/database/query`,
        asyncBool:false,
        body:`SELECT * FROM interrogation_PLOTLY;`
    })
    // }  /**/
    
    function generateParcat(data) {
        // Preprocess Data
        var carsData = []
        parcats_FL_3_i.forLoopLength = data.length
        parcats_FL_3_i.args.target = carsData
        parcats_FL_3_i.args.source = data
        ultraObject.forLoop(   parcats_FL_3_i   )
        var categoricalDimensions = categoricalDimensionLabels.map(
      function(dimLabel) {
        // Extract column
        var values = carsData.map(function(row) {
          return row[dimLabel]
        });

        return {
          values: values,
          label: dimLabel
        };
      }
    );
    
        // Colors
        var color = new Int8Array(carsData.length);
        var colorscale = [[0, 'gray'], [0.33, 'gray'],
                          [0.33, 'firebrick'], [0.66, 'firebrick'],
                          [0.66, 'blue'], [1.0, 'blue']];
    
        // Layout
        var layout = {
            width: 1400,
            height: 800,
            xaxis: {title: 'Horsepower'},
            yaxis: {domain: [0.6, 1], title: 'MPG'},
            dragmode: 'lasso',
            hovermode: 'closest'
        };
    
        // Build Traces
        var traces = [
            {type: 'parcats',
             domain: {y: [0, 10.4]},
             dimensions:categoricalDimensions,
             line: {
               colorscale: colorscale,
               cmin: -0.5,
               cmax: 2.5,
               //color: color,
               width:500,
               shape: 'hspline'},
            labelfont: {size: 14}
            }
        ];
    
        // Make plot
        Plotly.newPlot(gd, traces, layout);
    
        // Update color on selection and click
        var update_color = function(points_data) {
      var new_color = color;
      var color_value = document.querySelector('input[name="rate"]:checked').value;
      console.log(color_value);
      var selection = []
      for(var i = 0; i < points_data.points.length; i++) {
        new_color[points_data.points[i].pointNumber] = color_value;
        selection.push(points_data.points[i].pointNumber);
      }

      // Update selected points in scatter plot
      Plotly.restyle(gd, {'marker.color': [new_color]}, 0)

      // Update color of selected paths in parallel categories diagram
      Plotly.restyle(gd,
                     {'line.color': [new_color]}, 1)
    };
    
        gd.on('plotly_selected', update_color);
        gd.on('plotly_click', update_color);
    }
    
    /*generating a  random samplye*/  //{
    parcats_XHR_0_i  =  ultraObject.scope.add(   {value:ultraObject.XHR.abelast[ultraObject.XHR.abelast.length -1]}   )
    ultraObject.forLoop(   parcats_FL_1_i    )
    console.log(   randomData   )
    generateParcat(   randomData   )
    // }  /**/
    
});

//     var resolveDiv1 = new Promise((resolve,reject)=>{
// var gd = document.getElementById('myDiv1');
// var categoricalDimensionLabels = [
//   'body-style',
//   'drive-wheels',
//   'aspiration',
//   'symboling',
//   'num-of-doors',
//   'more-type',

// ];

// Plotly.d3.csv(
//     'https://raw.githubusercontent.com/plotly/datasets/master/imports-85.csv',
//     function(carsData) {
//     // Preprocess Data
//     // var mpg = carsData.map(function(row) { return row['highway-mpg'] });
//     // var horsepower = carsData.map(function(row) { return row['horsepower'] });
//     console.log(carsData)
//     var categoricalDimensions = categoricalDimensionLabels.map(
//       function(dimLabel) {
//         // Extract column
//         var values = carsData.map(function(row) {
//           return row[dimLabel]
//         });

//         return {
//           values: values,
//           label: dimLabel
//         };
//       }
//     );

//     // Colors
//     var color = new Int8Array(carsData.length);
//     var colorscale = [[0, 'gray'], [0.33, 'gray'],
//                       [0.33, 'firebrick'], [0.66, 'firebrick'],
//                       [0.66, 'blue'], [1.0, 'blue']];

//     // Layout
//     var layout = {
//       width: 6000,
//       height: 800,
//       xaxis: {title: 'Horsepower'},
//       yaxis: {domain: [0.6, 1], title: 'MPG'},
//       dragmode: 'lasso',
//       hovermode: 'closest'
//     };

//     // Build Traces
//     var traces = [
//     //   {type: 'scatter',
//     //   x: horsepower,
//     //   y: mpg,
//     //   marker: {color: color,
//     //             colorscale: colorscale,
//     //             cmin: -0.5,
//     //             cmax: 2.5,
//     //             showscale: true,
//     //             colorbar: {tickvals: [0, 1, 2],
//     //                       ticktext: ['None', 'Red', 'Blue']}},
//     //   mode: 'markers',
//     //   },
//       {type: 'parcats',
//       domain: {y: [0, 10.4]},
//       dimensions:categoricalDimensions,
//       line: {
//          colorscale: colorscale,
//          cmin: -0.5,
//          cmax: 2.5,
//          //color: color,
//          width:500,
//          shape: 'hspline'},
//       labelfont: {size: 14}
//       }
//     ];

//     // Make plot
//     Plotly.newPlot(gd, traces, layout);

//     // Update color on selection and click
//     var update_color = function(points_data) {
//       var new_color = color;
//       var color_value = document.querySelector('input[name="rate"]:checked').value;
//       console.log(color_value);
//       var selection = []
//       for(var i = 0; i < points_data.points.length; i++) {
//         new_color[points_data.points[i].pointNumber] = color_value;
//         selection.push(points_data.points[i].pointNumber);
//       }

//       // Update selected points in scatter plot
//       Plotly.restyle(gd, {'marker.color': [new_color]}, 0)

//       // Update color of selected paths in parallel categories diagram
//       Plotly.restyle(gd,
//                      {'line.color': [new_color]}, 1)
//     };

//     gd.on('plotly_selected', update_color);
//     gd.on('plotly_click', update_color);
//   });
// })
//     var resolveDiv2 = new Promise((resolve,reject)=>{
// var gd = document.getElementById('myDiv2');
// var categoricalDimensionLabels = [
//   'body-style',
//   'drive-wheels',
//   'aspiration',
//   'symboling',
//   'num-of-doors',
//   'more-type',

// ];

// Plotly.d3.csv(
//     'https://raw.githubusercontent.com/plotly/datasets/master/imports-85.csv',
//     function(carsData) {
//     // Preprocess Data
//     // var mpg = carsData.map(function(row) { return row['highway-mpg'] });
//     // var horsepower = carsData.map(function(row) { return row['horsepower'] });
//     console.log(carsData)
//     var categoricalDimensions = categoricalDimensionLabels.map(
//       function(dimLabel) {
//         // Extract column
//         var values = carsData.map(function(row) {
//           return row[dimLabel]
//         });

//         return {
//           values: values,
//           label: dimLabel
//         };
//       }
//     );

//     // Colors
//     var color = new Int8Array(carsData.length);
//     var colorscale = [[0, 'gray'], [0.33, 'gray'],
//                       [0.33, 'firebrick'], [0.66, 'firebrick'],
//                       [0.66, 'blue'], [1.0, 'blue']];

//     // Layout
//     var layout = {
//       width: 6000,
//       height: 800,
//       xaxis: {title: 'Horsepower'},
//       yaxis: {domain: [0.6, 1], title: 'MPG'},
//       dragmode: 'lasso',
//       hovermode: 'closest'
//     };

//     // Build Traces
//     var traces = [
//     //   {type: 'scatter',
//     //   x: horsepower,
//     //   y: mpg,
//     //   marker: {color: color,
//     //             colorscale: colorscale,
//     //             cmin: -0.5,
//     //             cmax: 2.5,
//     //             showscale: true,
//     //             colorbar: {tickvals: [0, 1, 2],
//     //                       ticktext: ['None', 'Red', 'Blue']}},
//     //   mode: 'markers',
//     //   },
//       {type: 'parcats',
//       domain: {y: [0, 10.4]},
//       dimensions:categoricalDimensions,
//       line: {
//          colorscale: colorscale,
//          cmin: -0.5,
//          cmax: 2.5,
//          //color: color,
//          width:500,
//          shape: 'hspline'},
//       labelfont: {size: 14}
//       }
//     ];

//     // Make plot
//     Plotly.newPlot(gd, traces, layout);

//     // Update color on selection and click
//     var update_color = function(points_data) {
//       var new_color = color;
//       var color_value = document.querySelector('input[name="rate"]:checked').value;
//       console.log(color_value);
//       var selection = []
//       for(var i = 0; i < points_data.points.length; i++) {
//         new_color[points_data.points[i].pointNumber] = color_value;
//         selection.push(points_data.points[i].pointNumber);
//       }

//       // Update selected points in scatter plot
//       Plotly.restyle(gd, {'marker.color': [new_color]}, 0)

//       // Update color of selected paths in parallel categories diagram
//       Plotly.restyle(gd,
//                      {'line.color': [new_color]}, 1)
//     };

//     gd.on('plotly_selected', update_color);
//     gd.on('plotly_click', update_color);
//   });
// })
    




            
</script>
</html>